Repository: Products.LinguaPlone


Branch: refs/heads/master
Date: 2018-02-09T10:20:40+01:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.LinguaPlone/commit/89a5b4e8bf25e84c174539825e91068806248026

start translation linker browser popup from portal object and not context

Files changed:
M Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt

diff --git a/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt b/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt
index 78576a9..7781344 100644
--- a/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt
+++ b/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt
@@ -145,7 +145,7 @@
                     </div>
 
                     <div class="field"
-                         tal:define="startup_directory context/absolute_url;
+                         tal:define="startup_directory context/portal_url;
                                      value request/link_content | nothing;
                                      fieldName string:link_content;
                                      fieldRealName fieldName;


Repository: Products.LinguaPlone


Branch: refs/heads/master
Date: 2018-02-09T10:41:42+01:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.LinguaPlone/commit/8d3d5bbf2f6e411de423c966c33f1181108fe002

show full breadcrumb on pop-up coming from portal_root

Files changed:
A Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py
M Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt

diff --git a/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt
index ff479e3..320d437 100644
--- a/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt
+++ b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt
@@ -95,7 +95,7 @@
                      tal:condition= "python:search_text==''"
                      tal:define=    "portal here/portal_url/getPortalObject;
                                      putils nocall:portal/plone_utils;
-                                     crumbs python:putils.createBreadCrumbs(here);
+                                     crumbs context/translationbrowser_popup_full_breadcrumbs;
                                      isRTL context/@@plone_portal_state/is_rtl;
                                      parents request/PARENTS;
                                      nil python: parents.reverse();">
diff --git a/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py
new file mode 100644
index 0000000..3976613
--- /dev/null
+++ b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py
@@ -0,0 +1,16 @@
+## Script (Python) "translationbrowser_popup_full_breadcrumbs"
+##bind container=container
+##bind context=context
+##bind namespace=
+##bind script=script
+##bind subpath=traverse_subpath
+##parameters=
+##title=Return full breadcrumbs from portal_root til context
+##
+items = []
+while context.portal_type != 'Plone Site':
+    items.append(context)
+    context = context.aq_parent
+
+items.reverse()
+return items


Repository: Products.LinguaPlone


Branch: refs/heads/master
Date: 2018-02-09T10:49:38+01:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.LinguaPlone/commit/7e6e7b8aa2676e18c1a382d2e29e34e462afa8ae

changelog

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index ae1452a..7c83081 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,11 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- The breadcrumb shown on the translation linker pop-up shows the full site
+  [erral]
+
+- Translation linker pop-up is opened on the portal root
+  [erral]
 
 Bug fixes:
 


Repository: Products.LinguaPlone


Branch: refs/heads/master
Date: 2018-02-21T11:05:35+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.LinguaPlone/commit/d111fbb8c638457be5b2d362e184013722727a79

Merge pull request #26 from erral/translation-linker-from-portal-root

Show translation linker pop-up contents from portal root

Files changed:
A Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py
M CHANGES.rst
M Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt
M Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index ae1452a..7c83081 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,11 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- The breadcrumb shown on the translation linker pop-up shows the full site
+  [erral]
+
+- Translation linker pop-up is opened on the portal root
+  [erral]
 
 Bug fixes:
 
diff --git a/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt b/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt
index 78576a9..7781344 100644
--- a/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt
+++ b/Products/LinguaPlone/skins/LinguaPlone/manage_translations_form.pt
@@ -145,7 +145,7 @@
                     </div>
 
                     <div class="field"
-                         tal:define="startup_directory context/absolute_url;
+                         tal:define="startup_directory context/portal_url;
                                      value request/link_content | nothing;
                                      fieldName string:link_content;
                                      fieldRealName fieldName;
diff --git a/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt
index ff479e3..320d437 100644
--- a/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt
+++ b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup.pt
@@ -95,7 +95,7 @@
                      tal:condition= "python:search_text==''"
                      tal:define=    "portal here/portal_url/getPortalObject;
                                      putils nocall:portal/plone_utils;
-                                     crumbs python:putils.createBreadCrumbs(here);
+                                     crumbs context/translationbrowser_popup_full_breadcrumbs;
                                      isRTL context/@@plone_portal_state/is_rtl;
                                      parents request/PARENTS;
                                      nil python: parents.reverse();">
diff --git a/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py
new file mode 100644
index 0000000..3976613
--- /dev/null
+++ b/Products/LinguaPlone/skins/LinguaPlone/translationbrowser_popup_full_breadcrumbs.py
@@ -0,0 +1,16 @@
+## Script (Python) "translationbrowser_popup_full_breadcrumbs"
+##bind container=container
+##bind context=context
+##bind namespace=
+##bind script=script
+##bind subpath=traverse_subpath
+##parameters=
+##title=Return full breadcrumbs from portal_root til context
+##
+items = []
+while context.portal_type != 'Plone Site':
+    items.append(context)
+    context = context.aq_parent
+
+items.reverse()
+return items


